<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>Mô phỏng Thuật toán Sắp xếp Nổi bọt</title>
    <style>
        .hero {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
            padding: 10rem 2rem 6rem;
            color: white;
            text-align: center;
        }

        .hero-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1.5rem;
            color: white;
            font-weight: 800;
            line-height: 1.2;
        }

        .hero p {
            font-size: 1.3rem;
            margin-bottom: 2rem;
            max-width: 600px;
            margin: 0 auto 2rem;
            color: rgba(255, 255, 255, 0.9);
        }

        footer {
            background: var(--bg-dark);
            color: white;
            padding: 4rem 2rem;
            text-align: center;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .centered-container {
            display: grid;
            place-items: center;
            height: 20vh;
        }

        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .hero p {
                font-size: 1.1rem;
            }

            .path-steps {
                grid-template-columns: 1fr;
            }
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: white;
            min-width: 176px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            top: 100%;
            left: 0;
            border-radius: 8px;
            padding: 10px 0;
        }

        .dropdown:hover .dropdown-content {
            display: block;
        }

        .dropdown-content a {
            color: #16a085;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }

        .dropdown-content a:hover {
            background-color: #16a085;
        }




        @keyframes highlight {
            0% {
                background-color: #ffd700;
                transform: scale(1.05);
            }

            100% {
                background-color: #e2e8f0;
                transform: scale(1);
            }
        }

        .search-item {
            transition: all 0.3s ease;
            position: relative;
        }

        .current-search {
            animation: highlight 0.5s;
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
            z-index: 10;
        }

        .found-item {
            background-color: #48bb78 !important;
            color: white;
            animation: pulse 1s infinite;
        }

        .not-found-item {
            opacity: 0.6;
        }

        * {
            transition: all 0.3s ease-in-out;
        }

        .container h1 {
            text-align: center;
            margin-bottom: 20px;
            /* Add some space below the heading */
            color: #16a085;
            /* Add a nice color */
        }

        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .control-group {
            background: #f8fafc;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .button-group {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .input-group {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            align-items: center;
        }

        button,
        select,
        input {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
        }

        button,
        select,
        input {
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            transition: all 0.3s;
        }

        button {
            background: #16a085;
            color: white;
            border: none;
            cursor: pointer;
        }

        button:hover:not(:disabled) {
            background: #1abc9c;
            transform: translateY(-2px);
        }

        button:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
        }

        .array-container {
            display: flex;
            gap: 15px;
            min-height: 250px;
            align-items: center;
            justify-content: center;
            margin: 30px 0;
            padding: 20px;
            background: #f8fafc;
            border-radius: 12px;
        }

        .array-box {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #16a085, #1abc9c);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            border-radius: 8px;
            transition: all 0.4s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .code-section {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 12px;
            margin-top: 30px;
        }

        .code-line {
            padding: 5px 10px;
            font-family: monospace;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }

            100% {
                transform: scale(1);
            }
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .two-column-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .code-section {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 12px;
        }

        .algorithm-section {
            background: #f8fafc;
            padding: 20px;
            border-radius: 12px;
        }

        .array-container {
            display: flex;
            gap: 15px;
            min-height: 250px;
            align-items: center;
            justify-content: center;
            margin: 30px 0;
            padding: 20px;
            background: #f8fafc;
            border-radius: 12px;
        }

        .array-box {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #16a085, #1abc9c);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            border-radius: 8px;
            transition: all 0.4s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }


        .code-line.active {
            background: #4a5568;
            color: #fbbf24;
        }

        .comparing {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            animation: pulse 0.8s infinite;
        }

        .swapping {
            background: linear-gradient(135deg, #fbbf24, #fbbf24);
            animation: bounce 0.5s;
        }

        .sorted {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }

            100% {
                transform: scale(1);
            }
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        /* Style cho dropdown */
        .dropdown {
            position: relative;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: white;
            min-width: 176px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            top: 100%;
            left: 50%;
            /* Đặt điểm neo ở giữa */
            transform: translateX(-50%);
            /* Dịch chuyển về trái 50% chiều rộng của chính nó */
            border-radius: 8px;
            padding: 10px 0;
            animation: dropdown-fade 0.3s ease-in-out;
        }

        /* Hiệu ứng hiển thị dropdown */
        @keyframes dropdown-fade {
            from {
                opacity: 0;
                transform: translate(-50%, -10px);
            }

            to {
                opacity: 1;
                transform: translate(-50%, 0);
            }
        }

        .dropdown:hover .dropdown-content {
            display: block;
        }

        .dropdown-content a {
            color: #16a085;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            transition: all 0.3s;
            text-align: center;
            /* Căn giữa text trong dropdown */
            min-width: 100%;
            /* Đảm bảo chiều rộng đầy đủ */
        }

        /* Hiệu ứng hover cho dropdown items */
        .dropdown-content a:hover {
            background-color: #16a085;
            color: white;
            transform: translateX(5px);
        }

        /* Hiệu ứng active cho dropdown items */
        .dropdown-content a:active {
            background-color: #1abc9c;
            transform: translateX(2px);
        }

        details {
            margin: 10px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }

        summary {
            font-size: 1 rem;
            /* Kích thước lớn hơn, giá trị tùy chỉnh */
            padding: 10px;
            cursor: pointer;
            font-weight: bold;
            color: #2c3e50;
            user-select: none;
            transition: background-color 0.3s;
        }

        summary:hover {
            background-color: #e9ecef;
        }

        details[open] summary {
            margin-bottom: 15px;
            border-bottom: 1px solid #dee2e6;
        }

        ul {
            padding-left: 40px;
            /* Thụt vào từ cạnh trái */
            margin: 0;
            /* Bỏ khoảng cách mặc định */
            list-style-type: disc;
            /* Hiển thị dấu chấm tròn trước mỗi mục */
        }

        li {
            margin-bottom: 5px;
            /* Khoảng cách giữa các mục */
        }

        table {
            width: 60%;
            margin: 20px auto;
            border-collapse: collapse;
            text-align: left;
            font-family: Arial, sans-serif;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 10px;
        }

        th {
            background-color: #f4f4f4;
            font-weight: bold;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        tr:hover {
            background-color: #f1f1f1;
        }

        label {
            font-size: 16px;
            /* Đảm bảo kích thước chữ phù hợp */
            margin: 0;
        }

        .status-display {
            margin-top: 20px;
            padding: 15px;
            background: #f8fafc;
            border-radius: 8px;
            text-align: center;
            font-size: 16px;
            color: #2c3e50;
            min-height: 50px;
            border: 1px solid #e2e8f0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .status-comparing {
            color: #e74c3c;
            font-weight: bold;
        }

        .status-swapping {
            color: #fbbf24;
            font-weight: bold;
        }

        .status-complete {
            color: #3498db;
            font-weight: bold;
        }

        /* Hộp nổi bật cho mảng đầu vào và kết quả */
        .highlighted-box {
            background-color: #f0f8ff;
            border-left: 4px solid #16a085;
            padding: 10px;
            margin: 10px 0;
            font-size: 16px;
            font-weight: bold;
        }

        /* Bảng minh họa ví dụ */
        .example-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            text-align: left;
        }

        .example-table th,
        .example-table td {
            border: 1px solid #ddd;
            padding: 10px;
        }

        .example-table th {
            background-color: #f4f4f4;
            font-weight: bold;
            color: #333;
        }

        .example-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .example-table tr:hover {
            background-color: #f1f1f1;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr;
            /* Mặc định 1 cột */
            gap: 16px;
            /* Khoảng cách giữa các cột */
        }

        @media (min-width: 768px) {
            .grid {
                grid-template-columns: 1fr 1fr;
                /* Chia thành 2 cột khi màn hình rộng hơn 768px */
            }
        }

        .font-semibold {
            font-weight: 600;
        }

        .text-green-700 {
            color: #15803d;
        }

        .text-red-700 {
            color: #B91C1C;
        }

        .list-disc {
            list-style-type: disc;
        }

        .list-inside {
            padding-left: 0;
        }

        :root {
            --primary: #2c3e50;
            --primary-light: #34495e;
            --secondary: #16a085;
            --secondary-light: #1abc9c;
            --accent: #e74c3c;
            --text: #2c3e50;
            --bg-light: #f5f6fa;
            --bg-dark: #2c3e50;
            --danger: #f44336;
            --danger-dark: #d32f2f;
            --success: #4CAF50;
            --success-dark: #45a049;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.12);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
            --radius-md: 8px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        body {
            background-color: var(--bg-light);
            line-height: 1.5;
            color: var(--text);
            min-height: 100vh;
        }

        .navbar {
            background: rgba(255, 255, 255, 0.98);
            padding: 1rem 2rem;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow-sm);
        }

        .nav-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            color: var(--secondary);
            font-size: 1.5rem;
            font-weight: bold;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo span {
            color: var(--secondary-light);
        }

        .nav-user {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .logout-btn {
            padding: 0.5rem 1rem;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .logout-btn:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 6rem 2rem 2rem;
        }

        .content-section {
            background: white;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-md);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.25rem;
            color: var(--text);
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--bg-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .list-item {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            align-items: center;
            gap: 2rem;
            padding: 1rem;
            border-radius: var(--radius-md);
            transition: all 0.3s;
        }

        .list-item:hover {
            background: var(--bg-light);
            transform: translateX(4px);
        }

        .list-item:not(:last-child) {
            border-bottom: 1px solid var(--bg-light);
        }

        .item-name {
            font-size: 1rem;
            font-weight: 500;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .item-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-light);
            border-radius: 6px;
            color: var(--secondary);
        }

        .status {
            text-align: center;
            font-weight: 500;
            padding: 0.5rem;
            border-radius: 20px;
            min-width: 100px;
        }

        .watched {
            color: var(--success);
            background: #ecfdf5;
        }

        .not-watched {
            color: var(--danger);
            background: #fef2f2;
        }

        .btn {
            background-color: var(--secondary);
            color: white;
            padding: 0.625rem 1.25rem;
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-weight: 500;
            font-size: 0.875rem;
            transition: all 0.2s;
            width: 120px;
            justify-self: end;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn:hover {
            background-color: var(--secondary-light);
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }

        .btn.disabled {
            background-color: #9ca3af;
            cursor: not-allowed;
        }

        .reset-container {
            text-align: center;
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 2px solid var(--bg-light);
        }

        .reset-btn {
            background-color: var(--danger);
            padding: 0.75rem 2rem;
            font-size: 1rem;
            width: auto;
            min-width: 200px;
        }

        .reset-btn:hover {
            background-color: var(--danger-dark);
        }

        @media (max-width: 768px) {
            .list-item {
                grid-template-columns: 1fr;
                gap: 1rem;
                text-align: center;
            }

            .item-name {
                justify-content: center;
            }

            .btn {
                justify-self: center;
            }

            .nav-content {
                flex-direction: column;
                gap: 1rem;
            }

            .nav-user {
                width: 100%;
                justify-content: center;
            }
        }

        .nav-user {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .user-name {
            color: #2c3e50;
            font-weight: 500;
            white-space: nowrap;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            min-width: 40px;
            min-height: 40px;
            background: #16a085;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1rem;
            text-transform: uppercase;
        }
    </style>
</head>

<body>
    <nav class="navbar">
        <div class="nav-content">
            <a href="Home.html" class="logo">Algo<span>Learn</span></a>
            <div class="nav-user">
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar"></div>
                    <span class="user-name" id="userNameDisplay"></span>
                </div>
                <button class="logout-btn" onclick="logout()">Đăng xuất</button>
            </div>
        </div>
    </nav>

    <div class="container">
        <h1>Thuật toán Sắp xếp Chọn (Selection Sort)</h1>
        <div class="content-wrapper">
            <details>
                <summary>I. Lý thuyết</summary>
                <div class="theory-content">
                    <h3>1. Khái niệm</h3>
                    <p>Selection Sort là thuật toán sắp xếp hoạt động bằng cách tìm phần tử nhỏ nhất (hoặc lớn nhất)
                        trong mảng chưa sắp xếp và hoán đổi nó với phần tử đầu tiên, sau đó lặp lại với phần mảng còn
                        lại.</p>

                    <h3>2. Nguyên lý hoạt động</h3>
                    <ul>
                        <li>Bắt đầu với phần tử đầu tiên của mảng.</li>
                        <li>Tìm phần tử nhỏ nhất (hoặc lớn nhất) trong phần chưa sắp xếp của mảng.</li>
                        <li>Hoán đổi phần tử nhỏ nhất (hoặc lớn nhất) với phần tử đầu tiên chưa được sắp xếp.</li>
                        <li>Lặp lại quá trình với phần còn lại của mảng cho đến khi toàn bộ mảng được sắp xếp.</li>
                    </ul>

                    <h3>3. Độ phức tạp</h3>
                    <strong>Thời gian:</strong><br>
                    - Trường hợp xấu nhất: O(n²) - Khi mảng ở trạng thái ngược hoàn toàn.<br>
                    - Trường hợp tốt nhất: O(n²) - Thuật toán luôn chạy với độ phức tạp này.<br>
                    <strong>Không gian:</strong> O(1) - Không yêu cầu bộ nhớ bổ sung.
                </div>
                <div>
                    <h3 class="text-xl font-semibold mb-2">4. Ưu và Nhược Điểm</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Cột 1: Ưu Điểm -->
                        <div>
                            <h4 class="font-semibold text-green-700">Ưu Điểm</h4>
                            <ul>
                                <li>Dễ cài đặt và hiểu.</li>
                                <li>Không yêu cầu bộ nhớ bổ sung (O(1)).</li>
                                <li>Hiệu quả với mảng nhỏ hoặc dữ liệu có cấu trúc đặc biệt.</li>
                            </ul>
                        </div>

                        <!-- Cột 2: Nhược Điểm -->
                        <div>
                            <h4 class="font-semibold text-red-700">Nhược Điểm</h4>
                            <ul>
                                <li>Hiệu suất kém với mảng lớn (O(n²)).</li>
                                <li>Không có tối ưu trong việc sắp xếp các mảng đã được sắp xếp một phần.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </details>

            <details>
                <summary>II. Minh họa bằng ví dụ</summary>
                <div class="example-content">
                    <h3>1. Mảng đầu vào</h3>
                    <p>Giả sử chúng ta cần sắp xếp mảng số sau theo thứ tự tăng dần:</p>
                    <div class="highlighted-box">
                        <strong>Mảng ban đầu:</strong> [5, 3, 8, 4, 2]
                    </div>
                    <h3>2. Các bước thực hiện</h3>
                    <p>Thuật toán sẽ tìm phần tử nhỏ nhất trong mảng chưa sắp xếp và đổi chỗ với phần tử đầu tiên của
                        phần đó. Quá trình lặp lại đến khi mảng được sắp xếp hoàn toàn.</p>
                    <table class="example-table">
                        <thead>
                            <tr>
                                <th>Lần lặp</th>
                                <th>Trạng thái mảng</th>
                                <th>Phần tử nhỏ nhất</th>
                                <th>Hành động</th>
                                <th>Mô tả</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>[5, 3, 8, 4, 2] → [2, 3, 8, 4, 5]</td>
                                <td>2</td>
                                <td>Đổi chỗ 5 ↔ 2</td>
                                <td>Tìm phần tử nhỏ nhất (2) và đổi chỗ với phần tử đầu tiên (5).</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>[2, 3, 8, 4, 5] → [2, 3, 8, 4, 5]</td>
                                <td>3</td>
                                <td>Giữ nguyên</td>
                                <td>Phần tử nhỏ nhất (3) đã ở đúng vị trí.</td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>[2, 3, 8, 4, 5] → [2, 3, 4, 8, 5]</td>
                                <td>4</td>
                                <td>Đổi chỗ 8 ↔ 4</td>
                                <td>Tìm phần tử nhỏ nhất (4) và đổi chỗ với phần tử đầu tiên của phần chưa sắp xếp (8).
                                </td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>[2, 3, 4, 8, 5] → [2, 3, 4, 5, 8]</td>
                                <td>5</td>
                                <td>Đổi chỗ 8 ↔ 5</td>
                                <td>Tìm phần tử nhỏ nhất (5) và đổi chỗ với 8.</td>
                            </tr>
                        </tbody>
                    </table>
                    <h3>3. Kết quả cuối cùng</h3>
                    <div class="highlighted-box">
                        <strong>Mảng kết quả:</strong> [2, 3, 4, 5, 8]
                    </div>
                    <h3>4. Giải thích</h3>
                    <p>Thuật toán **sắp xếp chọn** hoạt động bằng cách: 1. Duyệt qua toàn bộ phần chưa sắp xếp của mảng.
                        2. Tìm phần tử nhỏ nhất trong phần chưa sắp xếp. 3. Đổi chỗ phần tử nhỏ nhất với phần tử đầu
                        tiên của phần chưa sắp xếp. 4. Lặp lại quá trình trên cho đến khi toàn bộ mảng được sắp xếp.</p>
                    <p>Phương pháp này có độ phức tạp **O(n²)** vì nó duyệt qua mảng nhiều lần và thực hiện thao tác tìm
                        kiếm trên mỗi phần chưa sắp xếp.</p>
                </div>
            </details>
            <!-- Mô phỏng section -->
            <details open>
                <summary>III. Mô phỏng</summary>
                <div class="main-content">
                    <div class="two-column-section">
                        <div class="array-container" id="arrayContainer"></div>
                        <div class="code-section">
                            <h3>Mã nguồn thuật toán:</h3>
                            <div id="codeContainer">
                                <div class="code-line">def selection_sort(arr):</div>
                                <div class="code-line"> n = len(arr)</div>
                                <div class="code-line"> for i in range(n):</div>
                                <div class="code-line"> min_idx = i</div>
                                <div class="code-line"> for j in range(i + 1, n):</div>
                                <div class="code-line"> if arr[j] < arr[min_idx]:</div>
                                        <div class="code-line"> min_idx = j</div>
                                        <div class="code-line"> arr[i], arr[min_idx] = arr[min_idx], arr[i]</div>
                                        <div class="code-line"> return arr</div>
                                </div>
                            </div>
                            <div id="statusDisplay" class="status-display ">Trạng thái sẽ hiển thị tại đây</div>
                        </div>
                        <div class="controls">
                            <div class="control-group">
                                <div class="button-group">
                                    <button id="startBtn" onclick="startSort()">Bắt đầu</button>
                                    <button id="nextStepBtn" onclick="manualStep()" disabled>Bước tiếp</button>
                                    <button id="pauseBtn" onclick="togglePause()" disabled>Tạm dừng</button>
                                    <button id="resetBtn" onclick="resetArray()">Đặt lại</button>
                                </div>
                            </div>
                            <div class="control-group">
                                <div class="input-group">
                                    <select id="mode" class="mode-select">
                                        <option value="auto">Tự động</option>
                                        <option value="manual">Thủ công</option>
                                    </select>
                                    <input type="text" id="arrayInput" placeholder="Nhập mảng (VD: 5,3,8,4,2)" readonly>
                                    <button onclick="generateRandomArray()">Tạo ngẫu nhiên</button>
                                    <select id="sortOrder">
                                        <option value="asc">Tăng dần</option>
                                        <option value="desc">Giảm dần</option>
                                    </select>
                                    <input type="range" id="speed" min="1" max="5" value="3">
                                </div>
                            </div>
                        </div>

                        <div class="stats">
                            <div class="stat-card">
                                <h3>Thời gian</h3>
                                <div id="timeStats">0.00s</div>
                            </div>
                            <div class="stat-card">
                                <h3>So sánh</h3>
                                <div id="compareStats">0</div>
                            </div>
                            <div class="stat-card">
                                <h3>Hoán đổi</h3>
                                <div id="swapStats">0</div>
                            </div>
                        </div>
                    </div>

                    <script>
                        // Hàm lấy chữ cái đầu của tên người dùng
                        function getInitials(name) {
                            if (!name) return 'U';
                            return name
                                .split(' ')
                                .map(word => word[0])
                                .join('')
                                .toUpperCase()
                                .slice(0, 2);
                        }

                        // Cập nhật hiển thị avatar khi trang load
                        window.addEventListener('DOMContentLoaded', async function () {
                            const isAuthenticated = await checkAuthentication();

                            if (isAuthenticated) {
                                const username = localStorage.getItem('username');
                                if (username) {
                                    const userNameDisplay = document.getElementById('userNameDisplay');
                                    const userAvatar = document.getElementById('userAvatar');

                                    if (userNameDisplay) userNameDisplay.textContent = username;
                                    if (userAvatar) userAvatar.textContent = getInitials(username);
                                }
                            }
                        });
                        // Add this at the start of your script section in BinarySearch.html
                        const API_URL = 'https://9qs6kq-5000.csb.app/';

                        // Authentication check function
                        async function checkAuthentication() {
                            const token = localStorage.getItem('auth_token');

                            if (!token) {
                                console.log('No token found, redirecting to login');
                                window.location.href = 'Login.html';
                                return false;
                            }

                            try {
                                const response = await fetch(`${API_URL}/check-auth`, {
                                    method: 'GET',
                                    headers: {
                                        'Authorization': `Bearer ${token}`,
                                        'Content-Type': 'application/json'
                                    }
                                });

                                const data = await response.json();

                                if (!response.ok || !data.authenticated) {
                                    throw new Error('Authentication failed');
                                }

                                return true;
                            } catch (error) {
                                console.error('Auth check failed:', error);
                                clearAuthData();
                                window.location.href = 'Login.html';
                                return false;
                            }
                        }

                        // Clear auth data function
                        function clearAuthData() {
                            localStorage.removeItem('auth_token');
                            localStorage.removeItem('auth_user');
                            localStorage.removeItem('username');
                        }

                        // Updated logout function
                        function logout() {
                            clearAuthData();
                            // Use replace instead of href to prevent back button issues
                            window.location.replace('Login.html');
                        }

                        window.addEventListener('DOMContentLoaded', async function () {
                            const isAuthenticated = await checkAuthentication();

                            if (isAuthenticated) {
                                const username = localStorage.getItem('username');
                                if (username) {
                                    document.getElementById('userNameDisplay').textContent = username;
                                    document.getElementById('userAvatar').textContent = getInitials(username);
                                } else {
                                    document.getElementById('userNameDisplay').textContent = 'User';
                                    document.getElementById('userAvatar').textContent = 'U';
                                }
                            }
                        });
                        function parseArrayInput(input) {
                            // Remove all whitespaces
                            input = input.replace(/\s/g, '');

                            // Check if input is empty
                            if (!input) {
                                throw new Error('Mảng không được để trống');
                            }

                            // Split by comma and filter out empty strings
                            const parsedArray = input.split(',')
                                .filter(x => x !== '')
                                .map(x => {
                                    // Try to parse as integer
                                    const num = parseInt(x, 10);

                                    // Validate parsed number
                                    if (isNaN(num)) {
                                        throw new Error(`Giá trị "${x}" không hợp lệ. Vui lòng chỉ nhập số.`);
                                    }

                                    return num;
                                });

                            // Check if array is empty after parsing
                            if (parsedArray.length === 0) {
                                throw new Error('Mảng không hợp lệ');
                            }

                            return parsedArray;
                        }

                        // Global variables
                        let array = [];
                        let sortingInProgress = false;
                        let isPaused = false;
                        let currentStep = 0;
                        let timeStart;
                        let comparisons = 0;
                        let swaps = 0;
                        let sortInterval;
                        let currentI = 0;
                        let currentJ = 0;
                        let minIndex = 0;
                        let isAutoMode = true;

                        // Update the sortStep function to properly handle the first comparison
                        function sortStep() {
                            const n = array.length;
                            const isAscending = document.getElementById('sortOrder').value === 'asc';

                            if (currentI >= n - 1) {
                                completeSorting();
                                return;
                            }

                            // Always start by finding the minimum in the unsorted portion
                            highlightCode(4); // Highlight min_idx = i line

                            if (currentJ === n) {
                                // When we've completed an inner loop
                                highlightCode(7); // Highlight swap line
                                if (minIndex !== currentI) {
                                    // Perform swap
                                    [array[currentI], array[minIndex]] = [array[minIndex], array[currentI]];
                                    swaps++;
                                    updateStatus(`Hoán đổi phần tử ${array[minIndex]} với ${array[currentI]}`);
                                }

                                // Move to next outer loop iteration
                                currentI++;
                                currentJ = currentI + 1;
                                minIndex = currentI;

                                updateStats();
                                updateArrayDisplay();

                                if (currentI >= n - 1) {
                                    completeSorting();
                                }
                                return;
                            }

                            // Compare current element with current minimum
                            highlightCode(5); // Highlight comparison line
                            const comparison = isAscending ?
                                array[currentJ] < array[minIndex] :
                                array[currentJ] > array[minIndex];

                            comparisons++;
                            updateStatus(`So sánh ${array[currentJ]} với ${array[minIndex]}`);

                            if (comparison) {
                                highlightCode(6); // Highlight min_idx update line
                                minIndex = currentJ;
                            }

                            // Update visualization
                            updateArrayDisplay();
                            document.querySelectorAll('.array-box').forEach(box => {
                                const index = parseInt(box.getAttribute('data-index'));
                                if (index < currentI) {
                                    box.classList.add('sorted');
                                }
                                if (index === currentJ || index === minIndex) {
                                    box.classList.add('comparing');
                                }
                            });

                            currentJ++;
                            updateStats();
                        }

                        function updateArrayDisplay() {
                            const container = document.getElementById('arrayContainer');
                            container.innerHTML = '';

                            array.forEach((value, index) => {
                                const box = document.createElement('div');
                                box.className = 'array-box';
                                box.textContent = value;
                                box.setAttribute('data-index', index);

                                if (index < currentI) {
                                    box.classList.add('sorted');
                                }
                                if (sortingInProgress && (index === currentJ || index === minIndex)) {
                                    box.classList.add('comparing');
                                }

                                container.appendChild(box);
                            });
                        }

                        // Initialize the page
                        document.addEventListener('DOMContentLoaded', function () {
                            generateRandomArray();
                            updateControls();
                            updateArrayDisplay(true); // Pass true to prevent initial coloring

                            // Add event listeners
                            document.getElementById('mode').addEventListener('change', function (e) {
                                isAutoMode = e.target.value === 'auto';
                                updateControls();
                            });

                            document.getElementById('speed').addEventListener('input', function () {
                                if (sortingInProgress && !isPaused) {
                                    resetInterval();
                                }
                            });
                        });

                        // Generate random array
                        function generateRandomArray() {
                            array = Array.from({ length: 8 }, () => Math.floor(Math.random() * 50) + 1);
                            document.getElementById('arrayInput').value = ''; // Xóa giá trị trong ô input
                            resetArray();
                        }

                        // Reset array state
                        function resetArray() {
                            if (sortingInProgress) {
                                clearInterval(sortInterval);
                            }

                            // Chỉ parse mảng nếu ô input có giá trị
                            array = document.getElementById('arrayInput').value.trim() ?
                                document.getElementById('arrayInput').value.split(',').map(Number) :
                                array; // Giữ nguyên mảng nếu không có giá trị

                            // Phần còn lại giữ nguyên như cũ
                            sortingInProgress = false;
                            isPaused = false;
                            currentStep = 0;
                            currentI = 0;
                            currentJ = 0;
                            minIndex = 0;
                            comparisons = 0;
                            swaps = 0;

                            updateStats();
                            updateArrayDisplay(true);
                            updateControls();

                            document.querySelectorAll('.code-line').forEach(line => {
                                line.classList.remove('active');
                            });
                        }
                        function updateArrayDisplay(preventColoring = false) {
                            const container = document.getElementById('arrayContainer');
                            container.innerHTML = '';

                            array.forEach((value, index) => {
                                const box = document.createElement('div');
                                box.className = 'array-box';
                                box.textContent = value;
                                box.setAttribute('data-index', index);

                                if (!preventColoring) {
                                    // Mark sorted elements
                                    if (index < currentI) {
                                        box.classList.add('sorted');
                                    }

                                    // Special handling for initial comparison
                                    if (sortingInProgress) {
                                        if (currentI === 0 && currentJ === 1) {
                                            // For the first two elements, highlight the smaller one
                                            if (index === (array[0] <= array[1] ? 0 : 1)) {
                                                box.classList.add('comparing');
                                            }
                                        } else {
                                            // For subsequent comparisons
                                            if (index === minIndex) {
                                                box.classList.add('comparing');
                                            }
                                            if (index === currentJ) {
                                                box.classList.add('comparing');
                                            }
                                        }
                                    }
                                }

                                container.appendChild(box);
                            });
                        }
                        // Start sorting
                        function startSort() {
                            if (sortingInProgress) return;

                            sortingInProgress = true;
                            isPaused = false;
                            timeStart = Date.now();
                            currentI = 0;
                            currentJ = 1;
                            minIndex = 0;

                            // Initialize first comparison highlighting
                            updateArrayDisplay();
                            const firstElement = document.querySelector(`[data-index="${currentI}"]`);
                            const secondElement = document.querySelector(`[data-index="${currentJ}"]`);
                            if (firstElement && secondElement) {
                                firstElement.classList.add('comparing');
                                secondElement.classList.add('comparing');
                            }

                            updateStatus(`So sánh ${array[currentJ]} với ${array[currentI]}`);
                            updateControls();
                            highlightCode(5); // Highlight comparison line

                            if (isAutoMode) {
                                resetInterval();
                            } else {
                                manualStep();
                            }
                        }

                        // Reset interval for automatic mode
                        function resetInterval() {
                            if (sortInterval) {
                                clearInterval(sortInterval);
                            }
                            const speed = document.getElementById('speed').value;
                            // Điều chỉnh công thức tính interval để chậm hơn
                            const interval = 2000 / speed; // Tăng từ 1000 lên 2000 để giảm tốc độ gấp đôi

                            sortInterval = setInterval(() => {
                                if (!isPaused) {
                                    sortStep();
                                }
                            }, interval);
                        }

                        // Thêm labels để hiển thị tốc độ
                        const speedLabels = {
                            1: 'Rất chậm',
                            2: 'Chậm',
                            3: 'Trung bình',
                            4: 'Nhanh',
                            5: 'Rất nhanh'
                        };

                        // Cập nhật hiển thị label khi thay đổi tốc độ
                        document.getElementById('speed').addEventListener('input', function (e) {
                            const speed = e.target.value;
                            this.title = speedLabels[speed]; // Hiển thị label khi hover
                            if (sortingInProgress && !isPaused) {
                                resetInterval();
                            }
                        });

                        // Toggle pause
                        function togglePause() {
                            if (!sortingInProgress || !isAutoMode) return;

                            isPaused = !isPaused;

                            updateControls();
                            updateStatus(isPaused ? "Đã tạm dừng" : "Đang tiếp tục");

                            // If resuming, reset interval to continue sorting
                            if (!isPaused) {
                                resetInterval();
                            } else if (sortInterval) {
                                clearInterval(sortInterval);
                            }
                        }

                        // Manual step
                        function manualStep() {
                            if (!sortingInProgress || isAutoMode) return;

                            const n = array.length;
                            const isAscending = document.getElementById('sortOrder').value === 'asc';

                            if (currentI >= n - 1) {
                                completeSorting();
                                return;
                            }

                            if (currentJ === n) {
                                // When we've completed an inner loop iteration
                                highlightCode(7); // Highlight swap line
                                if (minIndex !== currentI) {
                                    [array[currentI], array[minIndex]] = [array[minIndex], array[currentI]];
                                    swaps++;
                                    updateStatus(`Hoán đổi phần tử ${array[minIndex]} với ${array[currentI]}`);
                                }

                                currentI++;
                                currentJ = currentI + 1;
                                minIndex = currentI;

                                updateStats();
                                updateArrayDisplay();

                                // If sorting is complete, trigger completion
                                if (currentI >= n - 1) {
                                    completeSorting();
                                }
                                return;
                            }

                            // Compare elements for finding minimum
                            highlightCode(5); // Highlight comparison line
                            const comparison = isAscending ?
                                array[currentJ] < array[minIndex] :
                                array[currentJ] > array[minIndex];

                            comparisons++;
                            updateStatus(`So sánh ${array[currentJ]} với ${array[minIndex]}`);

                            if (comparison) {
                                highlightCode(6); // Highlight min_idx update
                                minIndex = currentJ;
                            }

                            // Highlight comparing elements
                            updateArrayDisplay();
                            const currentElement = document.querySelector(`[data-index="${currentJ}"]`);
                            const minElement = document.querySelector(`[data-index="${minIndex}"]`);

                            // Remove previous comparing classes and add new ones
                            document.querySelectorAll('.array-box').forEach(box => box.classList.remove('comparing'));
                            currentElement.classList.add('comparing');
                            minElement.classList.add('comparing');

                            currentJ++;
                            updateStats();
                        }

                        // Complete sorting
                        function completeSorting() {
                            sortingInProgress = false;
                            clearInterval(sortInterval);
                            updateControls();
                            updateStatus("Sắp xếp hoàn tất!");

                            // Mark all elements as sorted
                            array.forEach((_, index) => {
                                const element = document.querySelector(`[data-index="${index}"]`);
                                element.classList.add('sorted');
                            });
                            highlightCode(8);
                        }

                        // Update statistics
                        function updateStats() {
                            document.getElementById('compareStats').textContent = comparisons;
                            document.getElementById('swapStats').textContent = swaps;
                            if (sortingInProgress) {
                                const elapsed = ((Date.now() - timeStart) / 1000).toFixed(2);
                                document.getElementById('timeStats').textContent = elapsed + 's';
                            }
                        }

                        // Update control buttons
                        function updateControls() {
                            document.getElementById('startBtn').disabled = sortingInProgress;
                            document.getElementById('pauseBtn').disabled = !sortingInProgress || !isAutoMode;
                            document.getElementById('nextStepBtn').disabled = !sortingInProgress || isAutoMode || isPaused;
                            document.getElementById('resetBtn').disabled = false;
                            document.getElementById('arrayInput').disabled = sortingInProgress;
                            document.getElementById('mode').disabled = sortingInProgress;
                            document.getElementById('sortOrder').disabled = sortingInProgress;
                        }

                        // Update status display
                        function updateStatus(message) {
                            const statusDisplay = document.getElementById('statusDisplay');
                            statusDisplay.textContent = message;
                        }

                        // Highlight active code line
                        function highlightCode(lineNumber) {
                            document.querySelectorAll('.code-line').forEach(line => {
                                line.classList.remove('active');
                            });
                            document.querySelectorAll('.code-line')[lineNumber].classList.add('active');
                        }
                    </script>
</body>

</html>